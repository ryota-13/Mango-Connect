<h1 class="text-center mt-4 mb-4"><%= @user.name %>さんのプロフィール</h1>

<div class="row align-items-center mb-4">
  <div class="col-md-3 text-center">
    <% if @user.image.attached? %>
      <%= image_tag @user.image, style: 'max-width: 150px; height: 150px; object-fit: cover;' %>
    <% else %>
      <%= image_tag 'no_image.jpg', style: 'max-width: 150px; height: 150px; object-fit: cover;' %>
    <% end %>
  </div>
  
  <div class="col-md-9">
    <p><strong>名前：</strong><%= @user.name %></p>
    <p><strong>Email：</strong><%= @user.email %></p>
    <p><strong>自己紹介：</strong><%= @user.profile %></p>
  </div>
</div>

<%= button_to '退会', admin_user_path(@user), method: :delete, data: { confirm: '本当にこのユーザーを退会させますか？' }, class: 'btn btn-danger mb-4' %> 
<%= link_to 'ユーザー一覧', admin_users_path, class: 'btn btn-secondary' %>


<h2 class="text-center mt-4 mb-4">投稿一覧</h2>

<% if @posts.present? %>
  <div class="row">
    <% @posts.each do |post| %>
      <div class="col-12 col-sm-6 col-md-4 col-lg-3 mb-4">
        <div class="card h-100 shadow-sm">
          <% if post.image.attached? %>
            <%= image_tag post.image, class: "card-img-top", style: "width: 100%; height: 200px; object-fit: contain;" %>
          <% end %>

          <div class="card-body d-flex flex-column">
            <h5 class="card-title"><%= post.title %></h5>
            <p class="card-text"><%= truncate(post.body, length: 100) %></p>
            <p class="card-text"><strong>コメント数: </strong><%= post.comments.count %></p>
            <p class="card-text">
              <small>投稿日: <%= post.created_at.in_time_zone("Asia/Tokyo").strftime("%Y年%m月%d日 %H:%M") %></small>
            </p>

            <div class="mt-auto d-flex justify-content-between">
              <%= link_to '投稿詳細', admin_post_path(post), class: 'btn btn-outline-info btn-sm' %>
              <%= button_to '投稿削除', admin_post_path(post),
                  method: :delete,
                  data: { confirm: '本当に削除しますか？' },
                  class: 'btn btn-outline-danger btn-sm' %>
            </div>
          </div>
        </div>
      </div>
    <% end %>
  </div>
<% else %>
  <p class="text-center">このユーザーの投稿はまだありません。</p>
<% end %>


<%= paginate @posts %> 